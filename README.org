#+title: Subscribe: a web interface for subscribing to mailing lists

If you use [[https://www.mailgun.com/][mailgun.com]], [[https://www.mailjet.com][mailjet.com]] or [[https://www.sendinblue.com/][sendinblue.com]] to manage
contacts/mailing lists but do not want your users to share data with
an third-party sign-up form, =Subscribe= can help.

If you have several mailing lists (possibly handled by several
different providers among mailgun/mailjet/sendinblue) and want to list
various list subscription options on a single page, =Subscribe= can
help.

[[file:subscribe.png]]

* Features

- Choose what mailing list to expose to your users
- Let the admin of a list receive an email every =x= subscriptions
- Customize the HTML header and footer of the web interface
- Use your own stylesheet (as long as it's based on [[https://bulma.io][bulma.io]])
- UI and transactional emails in english and french

* Configure

** Set up environment variables

Application variables:

: export SUBSCRIBE_SMTP_LOGIN="postmaster@xxx"
: export SUBSCRIBE_SMTP_PASSWORD="your-password"
: export SUBSCRIBE_SMTP_PORT=587
: export SUBSCRIBE_PORT=3000
: export SUBSCRIBE_BASEURL="http://yourdomain.com"

Backend-specific variables:

: export MAILGUN_API_KEY="your-key"
: 
: export SENDINBLUE_API_KEY="your-key"
: 
: export MAILJET_API_KEY="your-key"
: export MAILJET_API_SECRET="your-password"

Note that only mailjet.com requires both an API key /and password/,
mailgun.com and sendinblue.com only requires an API key.

** Define (mandatory) options in ~config.edn~

Copy ~config_example.edn~ to ~config.edn~ and edit it.

The mandatory configuration options are ~:admin-email~ ~:base-url~ and
~:backends~.

* Test

: ~$ git clone https://github.com/bzg/subscribe
: ~$ cd subscribe/
: ... [Set up your environment variables and config.edn]
: ~$ clj -A:test

* Run

** With ~clj -A:run~

: ~$ git clone https://github.com/bzg/subscribe
: ~$ cd subscribe/
: ... [Set up your configuration]
: ~$ clj -A:run

Then go to http://localhost:3000 or to your custom base URL.

** With =java -jar=

: ~$ git clone https://github.com/bzg/subscribe
: ~$ cd subscribe/
: ... [Set up your configuration]
: ~$ clj -A:jar
: ~$ java -jar target/subscribe.jar

** With docker

Assuming your environments variables are stored in =~/.subscribe_envs=
and you want to expose the 3000 port:

: ~$ git clone https://github.com/bzg/subscribe
: ~$ cd subscribe/
: ~$ docker build -t subscribe .
: ~$ docker run -it -p 3000:3000 --env-file=~/.subscribe_envs subscribe

Then go to http://localhost:3000.

* TODOs

- [ ] Catch errors before redirecting to the confirmation pages

* Support the Clojure ecosystem

If you like Clojure(script), please consider supporting maintainers by
donating to [[https://www.clojuriststogether.org][clojuriststogether.org]].

* License

=subscribe= is licensed under the [[http://www.eclipse.org/legal/epl-v10.html][Eclipse Public License 2.0]].
