#+title: Subscribe

* What it does?

Given a mailgun mailing list, create a subscription page.

* Configure

Add these variable environments:

| Env                   | What it defines     | Fallback value |
|-----------------------+---------------------+----------------|
| SUBSCRIBE_PORT        | The listening port  | 4321           |
| SUBSCRIBE_DB_URI      | The db URI          |                |
| SUBSCRIBE_BASE_URL    |                     |                |
| SUBSCRIBE_ADMIN_EMAIL |                     |                |
| SUBSCRIBE_RETURN_URL  |                     |                |
| MAILGUN_API_KEY       | The mailgun API key | N/A            |
| MAILGUN_FROM          |                     | N/A            |
| MAILGUN_LOGIN         |                     | N/A            |
| MAILGUN_PASSWORD      |                     | N/A            |

* Run

** With =lein run=

: ~$ git clone https://github.com/etalab/subscribe
: ~$ cd subscribe/
: ~$ lein run

Then go to http://localhost:4321.

** With =java -jar=

: ~$ git clone https://github.com/etalab/subscribe
: ~$ cd subscribe/
: ~$ lein uberjar
: ~$ java -jar target/subscribe-x.x.x-standalone.jar

** Changing the environment variables

To use a different port:

: ~$ SUBSCRIBE_PORT="1234" lein run

will run the application at http://localhost:1234

: ~$ SUBSCRIBE_PORT="1234" java -jar subscribe-x.x.x-standalone.jar

will do the same while running the application from a jar file.

* Todo

- Add unsubscribe link
- Enable antiforgery
- Send a nice error when email format is wrong (no js)
- Send an email to admin every X subscribers
- Add authentication tests
- Don't use wrap-reload in prod
- Update README.org

* License

=subscribe= is licensed under the [[http://www.eclipse.org/legal/epl-v10.html][Eclipse Public License 1.0]], the same
as Clojure.
